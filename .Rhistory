View(LnPhytoTer)
library(readxl)
View(receptor_status)
ERnomis <- na.omit(receptor_status)
View(ERnomis)
df <- merge(ERnomis, LnPhytoTer, by='Patient No.', all=F)
df <- merge(ERnomis, LnPhytoTer, by=0, all=F)
View(df)
library(readxl)
Allphyto <- read_excel("C:/Users/Siqiang Fan/Desktop/Allphyto.xlsx")
View(Allphyto)
lnrfs <- log(Allphyto$rfstime)
lnefs <- log(Allphyto$efstime)
lnrec <- log(Allphyto$rectime)
Lnall <- cbind(Allphyto, lnefs, lnrec, lnrfs)
View(Lnall)
Lnall[sapply(Lnall, is.infinite)] <- NA
Final <- na.omit(Lnall)
View(Final)
write.csv(Final, file = 'ErPhyt')
write.csv(Final, file = 'ErPhyt.csv')

library(MASS)
library(dplyr)
library(ggplot2)
library(factoextra)

PCA1 <- select(Final, lnTotal_phytoestrogens, lnrfs, lnTotal_phytoestrogensTer)
PCA1_pca <- prcomp(PCA1, scale = TRUE)
fviz_pca_biplot(PCA1_pca, label = 'var', habillage = Final$ER)
PCA1 <- select(Final, lnTotal_phytoestrogens, lnrfs)
PCA1_pca <- prcomp(PCA1, scale = TRUE)
fviz_pca_biplot(PCA1_pca, label = 'var', habillage = Final$ER)
fviz_pca_biplot(PCA1_pca, label = 'var', habillage = Final$lnTotal_phytoestrogensTer)
PCA1 <- select(Final, lnTotal_phytoestrogens, lnrfs, ER)
PCA1_pca <- prcomp(PCA1, scale = TRUE)
fviz_pca_biplot(PCA1_pca, label = 'var', habillage = Final$lnTotal_phytoestrogensTer)
PCA1 <- select(Final, lnTotal_phytoestrogens, lnrfs, ER, PR, HER2)
PCA1_pca <- prcomp(PCA1, scale = TRUE)
fviz_pca_biplot(PCA1_pca, label = 'var', habillage = Final$lnTotal_phytoestrogensTer)
PCA1 <- select(Final, lnTotal_phytoestrogens, rfstime, ER, PR, HER2)
PCA1_pca <- prcomp(PCA1, scale = TRUE)
fviz_pca_biplot(PCA1_pca, label = 'var', habillage = Final$lnTotal_phytoestrogensTer)
PCA1 <- select(Final, lnTotal_phytoestrogens, lnrfs)
PCA1_pca <- prcomp(PCA1, scale = TRUE)
fviz_pca_biplot(PCA1_pca, label = 'var', habillage = Final$lnTotal_phytoestrogensTer, title = 'lnrfstime and Total Phytoestrogens Biplot')
PCA1 <- select(Final, lnTotal_phytoestrogens, lnefs)
PCA1_pca <- prcomp(PCA1, scale = TRUE)
fviz_pca_biplot(PCA1_pca, label = 'var', habillage = Final$lnTotal_phytoestrogensTer, title = 'lnefstime and Total Phytoestrogens Biplot')
PCA1 <- select(Final, lnTotal_phytoestrogens, lnrec)
PCA1_pca <- prcomp(PCA1, scale = TRUE)
fviz_pca_biplot(PCA1_pca, label = 'var', habillage = Final$lnTotal_phytoestrogensTer, title = 'lnrectime and Total Phytoestrogens Biplot')

PCA2 <- select(Final, lnTotal_lignans, lnrfs)
PCA2_pca <- prcomp(PCA2, scale = TRUE)
fviz_pca_biplot(PCA2_pca, label = 'var', habillage = Final$lnTotLigTer, title = 'lnrfstime and Total Lignans Biplot')
PCA2 <- select(Final, lnTotal_lignans, lnefs)
PCA2_pca <- prcomp(PCA2, scale = TRUE)
fviz_pca_biplot(PCA2_pca, label = 'var', habillage = Final$lnTotLigTer, title = 'lnefstime and Total Lignans Biplot')
PCA2 <- select(Final, lnTotal_lignans, lnrec)
PCA2_pca <- prcomp(PCA2, scale = TRUE)
fviz_pca_biplot(PCA2_pca, label = 'var', habillage = Final$lnTotLigTer, title = 'lnrectime and Total Lignans Biplot')

PCA3 <- select(Final, lnTotal_enterolignans, lnrfs)
PCA3_pca <- prcomp(PCA3, scale = TRUE)
fviz_pca_biplot(PCA3_pca, label = 'var', habillage = Final$lnTotEntLigTer, title = 'lnrfstime and Total Enterolignans Biplot')
PCA3 <- select(Final, lnTotal_enterolignans, lnefs)
PCA3_pca <- prcomp(PCA3, scale = TRUE)
fviz_pca_biplot(PCA3_pca, label = 'var', habillage = Final$lnTotEntLigTer, title = 'lnefstime and Total Enterolignans Biplot')
PCA3 <- select(Final, lnTotal_enterolignans, lnrec)
PCA3_pca <- prcomp(PCA3, scale = TRUE)
fviz_pca_biplot(PCA3_pca, label = 'var', habillage = Final$lnTotEntLigTer, title = 'lnrectime and Total Enterolignans Biplot')
PCA3 <- select(Final, lnTotal_enterolignans, lnrec, lnrfs, lnefs)
PCA3_pca <- prcomp(PCA3, scale = TRUE)
fviz_pca_biplot(PCA3_pca, label = 'var', habillage = Final$lnTotEntLigTer, title = 'lnrectime and Total Enterolignans Biplot')
PCA3 <- select(Final, lnTotal_isoflavones, lnrfs)

PCA4 <- select(Final, lnTotal_isoflavones, lnrfs)
PCA4_pca <- prcomp(PCA4, scale = TRUE)
fviz_pca_biplot(PCA4_pca, label = 'var', habillage = Final$lnTotIsoTer, title = 'lnrfstime and Total Isoflavones Biplot')
PCA4 <- select(Final, lnTotal_isoflavones, lnefs)
PCA4_pca <- prcomp(PCA4, scale = TRUE)
fviz_pca_biplot(PCA4_pca, label = 'var', habillage = Final$lnTotIsoTer, title = 'lnefstime and Total Isoflavones Biplot')
PCA4 <- select(Final, lnTotal_isoflavones, lnrec)
PCA4_pca <- prcomp(PCA4, scale = TRUE)
fviz_pca_biplot(PCA4_pca, label = 'var', habillage = Final$lnTotIsoTer, title = 'lnrectime and Total Isoflavones Biplot')

PCA5 <- select(Final, lnTotal_isoflavones, lnrfs, ER)
PCA5_pca <- prcomp(PCA5, scale = TRUE)
fviz_pca_biplot(PCA5_pca, label = 'var', habillage = Final$lnTotIsoTer, title = 'lnrfstime and Total Isoflavones Biplot')
PCA5 <- select(Final, lnTotal_isoflavones, lnrfs)
PCA5_pca <- prcomp(PCA5, scale = TRUE)
fviz_pca_biplot(PCA5_pca, label = 'var', habillage = Final$ER, title = 'lnrfstime and Total Isoflavones Biplot')
PCA5 <- select(Final, lnTotal_isoflavones, lnefs)
PCA5_pca <- prcomp(PCA5, scale = TRUE)
fviz_pca_biplot(PCA5_pca, label = 'var', habillage = Final$ER, title = 'lnefstime and Total Isoflavones Biplot')
PCA5 <- select(Final, lnTotal_isoflavones, lnrec)
PCA5_pca <- prcomp(PCA5, scale = TRUE)
fviz_pca_biplot(PCA5_pca, label = 'var', habillage = Final$ER, title = 'lnrectime and Total Isoflavones Biplot')
PCA5 <- select(Final, lnTotal_phytoestrogens, lnrec)

PCA6 <- select(Final, lnTotal_phytoestrogens, lnrec)
PCA6_pca <- prcomp(PCA6, scale = TRUE)
fviz_pca_biplot(PCA6_pca, label = 'var', habillage = Final$ER, title = 'lnrfstime and Total Phytoestrogens Biplot')
fviz_pca_biplot(PCA6_pca, label = 'var', habillage = Final$ER, title = 'lnrectime and Total Phytoestrogens Biplot')
PCA6 <- select(Final, lnTotal_phytoestrogens, lnrfs)
PCA6_pca <- prcomp(PCA6, scale = TRUE)
fviz_pca_biplot(PCA6_pca, label = 'var', habillage = Final$ER, title = 'lnrfstime and Total Phytoestrogens Biplot')
PCA6 <- select(Final, lnTotal_phytoestrogens, lnefs)
PCA6_pca <- prcomp(PCA6, scale = TRUE)
fviz_pca_biplot(PCA6_pca, label = 'var', habillage = Final$ER, title = 'lnefstime and Total Phytoestrogens Biplot')

PCA7 <- select(Final, lnTotal_lignans, lnefs)
PCA7_pca <- prcomp(PCA7, scale = TRUE)
fviz_pca_biplot(PCA7_pca, label = 'var', habillage = Final$ER, title = 'lnefstime and Total Lignans Biplot')
PCA7 <- select(Final, lnTotal_lignans, lnrfs)
PCA7 <- select(Final, lnTotal_lignans, lnrfs)
PCA7_pca <- prcomp(PCA7, scale = TRUE)
fviz_pca_biplot(PCA7_pca, label = 'var', habillage = Final$ER, title = 'lnrfstime and Total Lignans Biplot')
PCA7 <- select(Final, lnTotal_lignans, lnrec)
PCA7_pca <- prcomp(PCA7, scale = TRUE)
fviz_pca_biplot(PCA7_pca, label = 'var', habillage = Final$ER, title = 'lnrectime and Total Lignans Biplot')

PCA8 <- select(Final, lnTotal_enterolignans, lnrfs)
PCA8_pca <- prcomp(PCA8, scale = TRUE)
fviz_pca_biplot(PCA8_pca, label = 'var', habillage = Final$ER, title = 'lnrfstime and Total Lignans Biplot')
PCA8 <- select(Final, lnTotal_enterolignans, lnefs)
PCA8_pca <- prcomp(PCA8, scale = TRUE)
fviz_pca_biplot(PCA8_pca, label = 'var', habillage = Final$ER, title = 'lnefstime and Total Lignans Biplot')
PCA8 <- select(Final, lnTotal_enterolignans, lnrec)
PCA8_pca <- prcomp(PCA8, scale = TRUE)
fviz_pca_biplot(PCA8_pca, label = 'var', habillage = Final$ER, title = 'lnrectime and Total Lignans Biplot')
library(MASS)
library(dplyr)
library(ggplots)
library(ggplot2)
library(factoextra)
PCA9 <- select(Final, lnTotal_phytoestrogenTer, lnrfs)
PCA9 <- select(Final, lnTotal_phytoestrogensTer, lnrfs)
PCA9_pca <- prcomp(PCA9, scale = TRUE)
fviz_pca_biplot(PCA9_pca, label = 'var', habillage = Final$lnTotal_phytoestrogensTer, title = 'lnrectime and Total Lignans Biplot')
